<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Jua&display=swap" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.9/dist/css/splide.min.css">
    <style>
        .p1{font-family : "Black Han Sans", sans-serif;
            font-weight: 400;
            font-style: normal;}
        .p2{font-family: "Jua", sans-serif;
            font-weight: 400;
            font-style: normal;}
        /* Custom height for carousel */
        .custom-height {
            height: 85vh !important;
            /* Adjust this value as needed */
        }
        .movie-poster {
            border-radius: 10px;
        }
        .splide__slide img {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }
        .splide__slide p {
            text-align: center;
            margin-top: 10px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        .main_image_text {
            position: absolute;
            top: 35%;
            left: 10%;
            color: white;
            font-size: 45px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .main_image_overview {
            position: absolute;
            top: 48%;
            left: 10%;
            color: white;
            font-size: 18px;
            max-width: 30%;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #moreButton {
            position: absolute;
            top: 85%;
            left: 10%;
            padding: 8px 16px;
            font-size: 12px;
            border: none;
            cursor: pointer;
            z-index: 3;
        }
        #moreButton2 {
            position: absolute;
            top: 85%;
            left: 10%;
            padding: 8px 16px;
            font-size: 12px;
            border: none;
            cursor: pointer;
            z-index: 3;
        }
        #moreButton3 {
            position: absolute;
            top: 85%;
            left: 10%;
            padding: 8px 16px;
            font-size: 12px;
            border: none;
            cursor: pointer;
            z-index: 3;
        }
        @media screen and (max-width: 768px) {
            .main_image_text, .main_image_overview {
                left: 5%;
                max-width: 90%;
            }
            .main_image_text {
                font-size: 24px;
            }
            .main_image_overview {
                font-size: 16px;
            }
            #moreButton {
                top: 85%;
                left: 10%;
                font-size: 10px;
                padding: 6px 12px;
            }
            #moreButton2 {
                top: 85%;
                left: 10%;
                font-size: 10px;
                padding: 6px 12px;
            }
            #moreButton3 {
                top: 85%;
                left: 10%;
                font-size: 10px;
                padding: 6px 12px;
            }
        }
        [data-carousel-item] {
            position: relative;
            display: block;
            width: 100%;
            height: 100%;
        }
        [data-carousel-item]::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0) 100%);
            z-index: 2; /* 이미지 위에 그라데이션을 표시하기 위해 */
        }
        [data-carousel-item] img {
            z-index: 1; /* 그라데이션 뒤에 이미지가 오도록 */
        }
        [data-carousel-item] .main_image_text , [data-carousel-item] .main_image_overview {
            position: absolute;
            z-index: 3; /* 텍스트가 그라데이션 위에 오도록 */
        }
    </style>
</head>
<body>

<nav class="z-50 relative max-w-screen-xl px-8 py-4 block w-full mx-auto text-black bg-white border shadow-md rounded-xl border-white/80
        bg-opacity-80 backdrop-blur-2xl backdrop-saturate-200">
    <div class="container flex items-center justify-between mx-auto text-blue-gray-900">
        <a href="/"
           class="mr-4 block cursor-pointer py-1 p1 font-medium text-2xl">
            CINE
        </a>
        <div class="black justify-end ">
            <ul class="flex flex-row gap-2 mb-0 mt-0 flex-row items-center gap-6">
                <li class="flex items-center p-1 font-sans text-sm font-medium leading-normal gap-x-2 text-blue-gray-900">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grid" viewBox="0 0 16 16">
                        <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5z"/>
                    </svg>
                    <a href="/movie" class="flex items-center p2 text-xl">
                        영화
                    </a>
                </li>
                <li class="flex items-center p-1 font-sans text-sm font-medium leading-normal gap-x-2 text-blue-gray-900">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-event" viewBox="0 0 16 16">
                        <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
                    </svg>
                    <a href="/reservation" class="flex items-center p2 text-xl">
                        예매
                    </a>
                </li>
            </ul>
        </div>
        <div class="flex items-center gap-x-1">
            <a href="/login" sec:authorize="isAnonymous"
               class="px-4 p2 py-2 text-xl text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none
         hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none inline-block">
                <span>로그인</span>
            </a>
            <a href="/logout" sec:authorize="isAuthenticated"
               class="px-4 p2 py-2 text-xl text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none
         hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none inline-block">
                <span>로그아웃</span>
            </a>
            <div id="userSection" data-role="USER" sec:authorize="!hasRole('ROLE_ADMIN')">
                <button id="menuButton" class="rounded-lg bg-gray-900 py-3 px-4 text-center align-middle font-sans text-lg font-bold uppercase text-white
                shadow-md shadow-gray-900/10 active:shadow-none disabled:pointer-events-none">
                    마이페이지
                </button>
                <ul id="dropdownMenu" role="menu" class="hidden absolute z-10 min-w-[120px] rounded-md border border-blue-gray-50 bg-white p-3 font-sans
            text-sm font-normal text-blue-gray-500 shadow-lg shadow-blue-gray-500/10 focus:outline-none">
                    <li role="menuitem" class="block w-full cursor-pointer select-none rounded-md px-3 pt-[9px] pb-2 text-start leading-tight
                transition-all hover:bg-blue-gray-50 hover:bg-opacity-80 hover:bg-gray-500/20">
                        <a href="/user/mypage1">개인정보수정</a>
                    </li>
                    <li role="menuitem" class="block w-full cursor-pointer select-none rounded-md px-3 pt-[9px] pb-2 text-start leading-tight
                transition-all hover:bg-blue-gray-50 hover:bg-opacity-80 hover:bg-gray-500/20">
                        <a href="/user/mypage2">예매내역확인</a>
                    </li>
                </ul>
            </div>
            <div id="adminSection" data-role="ADMIN" sec:authorize="hasRole('ROLE_ADMIN')">
                <button id="menuButton2" data-ripple-light="true" data-popover-target="menu"
                        class=" rounded-lg bg-gray-900 py-3 px-4 text-center align-middle font-sans text-lg font-bold uppercase text-white
            shadow-md shadow-gray-900/10 active:shadow-none disabled:pointer-events-none">
                    관리자페이지
                </button>
                <ul id="dropdownMenu2" role="menu" data-popover="menu" data-popover-placement="bottom"
                    class="hidden absolute z-10 min-w-[120px] rounded-md border border-blue-gray-50 bg-white p-3 font-sans
        text-sm font-normal text-blue-gray-500 shadow-lg shadow-blue-gray-500/10 focus:outline-none">
                    <li role="menuitem"
                        class="block w-full cursor-pointer select-none rounded-md px-3 pt-[9px] pb-2 text-start leading-tight
            transition-all hover:bg-blue-gray-50 hover:bg-opacity-80 hover:bg-gray-500/20">
                        <a href="/admin/member">회원관리</a>
                    </li>
                    <li role="menuitem"
                        class="block w-full cursor-pointer select-none rounded-md px-3 pt-[9px] pb-2 text-start leading-tight
            transition-all hover:bg-blue-gray-50 hover:bg-opacity-80 hover:bg-gray-500/20">
                        <a href="/admin/adminTheater">상영관 관리</a>
                    </li>

                    <li role="menuitem"
                        class="block w-full cursor-pointer select-none rounded-md px-3 pt-[9px] pb-2 text-start leading-tight
            transition-all hover:bg-blue-gray-50 hover:bg-opacity-80 hover:bg-gray-500/20">
                        <a href="/admin/adminMovie">영화 관리</a>
                    </li>
                </ul>
            </div>
        </div>

    </div>
</nav>


<div class="mx-auto container">
    <div id="default-carousel" class="relative" data-carousel="static">
        <!-- Carousel wrapper -->
        <div class="overflow-hidden relative rounded-lg sm:h-72 xl:h-96 2xl:h-128 custom-height">
            <div class="hidden duration-700 ease-in-out" data-carousel-item>
                <img th:if="${movies.size() > 0}" th:src="@{'https://image.tmdb.org/t/p/w1280' + ${movies[1].backdropPath}}"
                     class="block absolute top-1/2 left-1/2 w-full h-full -translate-x-1/2 -translate-y-1/2 object-cover" alt="Main Movie Poster 1">
                <h2 class="main_image_text">
                    <span th:text="${movies[1].title}"></span>
                </h2>
                <h3 class="main_image_overview">
                    <span th:text="${movies[1].overview}"></span>
                </h3>
                <a th:href="@{/movieInfo/{id}(id=${movies[1].id})}">
                    <button id="moreButton" class="align-middle select-none font-sans font-bold text-center uppercase transition-all
                    disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-xs rounded-lg bg-white text-black
                    shadow-md shadow-gray-900/10 hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none"
                    >더보기..</button>
                </a>
            </div>
            <div class="hidden duration-700 ease-in-out" data-carousel-item>
                <img th:if="${movies.size() > 0}" th:src="@{'https://image.tmdb.org/t/p/w1280' + ${movies[2].backdropPath}}"
                     class="block absolute top-1/2 left-1/2 w-full h-full -translate-x-1/2 -translate-y-1/2 object-cover" alt="Main Movie Poster 1">
                <h2 class="main_image_text">
                    <span th:text="${movies[2].title}"></span>
                </h2>
                <h3 class="main_image_overview">
                    <span th:text="${movies[2].overview}"></span>
                </h3>
                <a th:href="@{/movieInfo/{id}(id=${movies[2].id})}">
                    <button id="moreButton2" class="align-middle select-none font-sans font-bold text-center uppercase transition-all
                    disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-xs rounded-lg bg-white text-black
                    shadow-md shadow-gray-900/10 hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none"
                    >더보기..</button>
                </a>
            </div>
            <div class="hidden duration-700 ease-in-out" data-carousel-item>
                <img th:if="${movies.size() > 0}" th:src="@{'https://image.tmdb.org/t/p/w1280' + ${movies[3].backdropPath}}"
                     class="block absolute top-1/2 left-1/2 w-full h-full -translate-x-1/2 -translate-y-1/2 object-cover" alt="Main Movie Poster 1">
                <h2 class="main_image_text">
                    <span th:text="${movies[3].title}"></span>
                </h2>
                <h3 class="main_image_overview">
                    <span th:text="${movies[3].overview}"></span>
                </h3>
                <a th:href="@{/movieInfo/{id}(id=${movies[3].id})}">
                    <button id="moreButton3" class="align-middle select-none font-sans font-bold text-center uppercase transition-all
                    disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-xs rounded-lg bg-white text-black
                    shadow-md shadow-gray-900/10 hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none"
                    >더보기..</button>
                </a>
            </div>
        </div>
        <!-- Slider indicators -->
        <div class="flex absolute bottom-5 left-1/2 z-30 space-x-3 -translate-x-1/2">
            <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 1" data-carousel-slide-to="0"></button>
            <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 2" data-carousel-slide-to="1"></button>
            <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 3" data-carousel-slide-to="2"></button>
        </div>
        <!-- Slider controls -->
        <button type="button" class="flex absolute top-0 left-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none" data-carousel-prev>
            <span class="inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                <svg class="w-5 h-5 text-white sm:w-6 sm:h-6 dark:text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                <span class="hidden">Previous</span>
            </span>
        </button>
        <button type="button" class="flex absolute top-0 right-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none" data-carousel-next>
            <span class="inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                <svg class="w-5 h-5 text-white sm:w-6 sm:h-6 dark:text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                <span class="hidden">Next</span>
            </span>
        </button>
    </div>

    <script src="https://unpkg.com/flowbite@1.4.0/dist/flowbite.js"></script>
</div>


<header class="bg-white border-b py-8">
    <div class="container mx-auto flex justify-between">
        <div class="text-3xl text-gray-800 font-bold">영화 차트</div>
        <button onclick="viewAllMovies()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            <a th:href="@{/movie}">전체보기</a>
        </button>
    </div>
</header>

<!-- Splide HTML 구조 -->
<div id="image-slider" class="splide max-w-screen-xl px-8 py-4 block w-full mx-auto">
    <div class="splide__track">
        <ul class="splide__list">
            <li class="splide__slide" th:each="movie, stat : ${movies}" th:if="${stat.index > 0 and stat.index < 9}">
                <a th:href="@{/movieInfo/{id}(id=${movie.id})}">
                    <img th:src="|https://image.tmdb.org/t/p/w500${movie.posterPath}|" alt="Movie Poster" class="movie-poster"/>
                    <p th:text="${movie.title}">Movie Title</p>
                </a>
            </li>
        </ul>
    </div>
</div>


<footer class="bg-gray-800">
    <div class="container mx-auto text-center py-6">
        <div class="text-sm text-gray-200 font-bold mb-2">
            <!-- Team members' names -->
            <div class="mb-2">
                TEAM
                <br>
                오건 | 정주현 | 고민석
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@3.6.9/dist/js/splide.min.js"></script>

<script>


    document.addEventListener('DOMContentLoaded', function() {
        loadMovies();
    });

    window.onscroll = function() {scrollFunction()};

    function scrollFunction() {
        if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {
            document.getElementById("navbar").style.padding = "1rem 0";
        } else {
            document.getElementById("navbar").style.padding = "2rem 0";
        }
    }
    function reserveMovie(title){
        window.location.href ='reservation.html'
    }

    document.addEventListener("DOMContentLoaded", function() {
        const userSection = document.getElementById("userSection");
        const adminSection = document.getElementById("adminSection");

        if (userSection) {
            document.getElementById("menuButton").addEventListener("click", function() {
                const dropdownMenu = document.getElementById("dropdownMenu");
                dropdownMenu.classList.toggle("hidden");
            });
        }

        if (adminSection) {
            document.getElementById("menuButton2").addEventListener("click", function() {
                const dropdownMenu2 = document.getElementById("dropdownMenu2");
                dropdownMenu2.classList.toggle("hidden");
            });
        }
    });

    /**
     * splide 다중 슬라이더 구문
     * 옵션 수정 or 삭제 : https://splidejs.com/guides/options/
     */
    document.addEventListener('DOMContentLoaded', function() {
        new Splide('#image-slider', {
            type   : 'loop',    // 무한루프
            perPage: 4,         // 한번에 보여지는 이미지의 개수
            perMove: 4,         // 한번의 이동으로 움직이는 이미지의 개수
            gap: '50px',        // 이미지 사이의 간격
            breakpoints: {
                1200: { // 화면 너비가 1200px 이하일 때
                    gap: '30px',
                },
                768: { // 화면 너비가 768px 이하일 때
                    gap: '20px',
                },
                480: { // 화면 너비가 480px 이하일 때
                    gap: '10px',
                },
            }
        }).mount();
    });
</script>
</body>
</html>